CPU=`sysctl -a hw 2>&1 | grep 'hw.availcpu' | sed 's|hw.availcpu = *||'`
let J=$CPU+1
if [[ $J -gt 4 ]]; then let J=4; fi

mk_add_options MOZ_OBJDIR=@TOPSRCDIR@/firefox-debug
mk_add_options MOZ_MAKE_FLAGS=-j${J}
mk_add_options MOZ_CO_PROJECT=browser
mk_add_options AUTOCONF=autoconf213

ac_add_options --with-macos-sdk=/Developer/SDKs/MacOSX10.5.sdk

ac_add_options --enable-application=browser
ac_add_options --enable-debug
ac_add_options --disable-optimize
ac_add_options --disable-jemalloc
# libxul required for packaging.
ac_add_options --enable-libxul
# do not strip symbols in packaged builds
ac_add_options --disable-install-strip

ac_add_options --enable-tests
#ac_add_options --enable-logrefcnt

# convert a.b.c to 100*a + 10*b + c for numeric comparisons.
tonumber() (IFS='. ';let v=0; m=100;digits="$1";for d in $digits; do let v=v+d*m; let m=m/10; done; echo $v)
# compare two numbers
lessthan() (if [[ `tonumber $1` -lt `tonumber $2` ]]; then return 0; else return 1; fi )

ac_add_options --with-valgrind=yes
ac_add_options --enable-valgrind=yes

ac_add_options --enable-accessibility

ac_add_options --enable-official-branding


# For NSS symbols
export MOZ_DEBUG_SYMBOLS=1

# Needed to enable breakpad in application.ini
export MOZILLA_OFFICIAL=1
