CPU=`cat /proc/cpuinfo | grep 'processor.*: [0-9]*' | wc -l`
let J=$CPU+1
if [[ $J -gt 4 ]]; then let J=4; fi

mk_add_options MOZ_OBJDIR=@TOPSRCDIR@/firefox-debug
mk_add_options MOZ_MAKE_FLAGS=-j${J}
mk_add_options MOZ_CO_PROJECT=browser

ac_add_options --enable-application=browser
ac_add_options --enable-debug
ac_add_options --disable-optimize
ac_add_options --disable-jemalloc
ac_add_options --enable-debug-symbols="-gdwarf-2"
# libxul required for packaging.
ac_add_options --enable-libxul
# do not strip symbols in packaged builds
ac_add_options --disable-install-strip

ac_add_options --enable-tests
ac_add_options --enable-logrefcnt
ac_add_options --with-valgrind
ac_add_options --enable-valgrind

ac_add_options --disable-installer
ac_add_options --enable-official-branding

export ac_cv_have_visibility_class_bug=yes

export CFLAGS="-gdwarf-2"
export CXXFLAGS="-gdwarf-2"

# For NSS symbols
export MOZ_DEBUG_SYMBOLS=1

# Needed to enable breakpad in application.ini
export MOZILLA_OFFICIAL=1

